# メール生成アプリ

CSVからメールアドレスを抽出し、固定テンプレートを適用して、1通ずつ確認しながらコピーして送れるローカルWebアプリです。

## 機能

- CSV/TSVファイルからメールアドレスを自動抽出
- Google Contacts由来のCSV（「E-mail 1 - Value」列）に対応
- メール列の自動検出（複数の検出ロジックを実装）
- 固定テンプレート（件名/本文）の適用
- 差し込み機能（`{{email}}` をメールアドレスに置換）
- 1件ずつページめくりUIで確認
- 各フィールド（宛先/件名/本文）の個別コピー機能
- 全部コピー機能（To/Subject/Bodyを一括）
- 送信済み管理（チェックボックス + localStorage保存）
- 未送信のみ表示フィルタ
- キーボードショートカット対応

## セットアップ

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:3000` を開いてください。

## 使い方

1. **CSVファイルのアップロード**
   - 画面上部の「CSV/TSVファイルをアップロード」からファイルを選択
   - Google ContactsからエクスポートしたCSVファイルに対応
   - `.numbers` ファイルは非対応（CSV/TSVでエクスポートしてください）

2. **テンプレートの設定**
   - 「件名テンプレート」と「本文テンプレート」を入力
   - `{{email}}` を使用するとメールアドレスに自動置換されます
   - 「テンプレートを保存」ボタンでlocalStorageに保存（次回起動時も保持）

3. **メールの確認とコピー**
   - ページめくりUIで1件ずつ確認
   - 「コピー」ボタンで各フィールドを個別にコピー
   - 「全部コピー」ボタンでTo/Subject/Bodyを一括コピー
   - Proton Webなどに貼り付けて手動で送信

4. **送信済み管理**
   - 各ページの「送信済み」チェックボックスで状態を管理
   - 「未送信のみ表示」をONにすると、送信済みをスキップして次へ移動

## キーボードショートカット

- `←` / `→`: 前へ / 次へ移動
- `Enter`: 次へ移動
- `Cmd/Ctrl + Shift + C`: 全部コピー

## 技術スタック

- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS
- PapaParse (CSV/TSVパース)
- localStorage (テンプレート・送信済み状態の保存)

## メール列の検出ロジック

1. 「E-mail 1 - Value」列を優先的に検出
2. 「E-mail」と「Value」を含む列を検出
3. 全セルを走査してメール形式の値が最も多い列を検出
4. それでも見つからない場合は、全セルからメールアドレスを抽出

## 注意事項

- クリップボード機能はHTTPSまたはlocalhostでのみ動作します
- ブラウザのlocalStorageを使用しているため、ブラウザを変更するとデータは引き継がれません
- CSVファイルは300行程度を想定していますが、それ以上でも動作します
